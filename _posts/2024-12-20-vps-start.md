---
layout: post
title: "vps-start"
date: 2024-12-20
excerpt_separator: <!--end_excerpt-->
---
简介: 本文记录vps部署过程
<!--end_excerpt-->

# 检测ip是否在线:
  * https://tcp.ping.pe/

# 检测是否开启cnd:
  * https://www.dnswatch.info/
  * DNS Lookup / IP lookup, 看不见原ip就是开启cdn了

# Windows ssh:
  * `scoop install nmap`
  * `ssh -o ProxyCommand="ncat --proxy-type socks5 --proxy 127.0.0.1:7890 %h %p" root@ip`
  * 如果重装后需要更新key:
    * `ssh-keygen -R <ip>`

# Ubuntu:
  * `sudo apt update && sudo apt upgrade -y`

# Docker:
  * `curl -fsSL https://test.docker.com -o test-docker.sh`
  * 解决报错: ![Running docker container : iptables: No chain/target/match by that name
](https://stackoverflow.com/questions/31667160/running-docker-container-iptables-no-chain-target-match-by-that-name)
    * `systemctl restart docker`

# bbrplus加速:
  * <https://github.com/jinwyp/one_click_script?tab=readme-ov-file#kernel>
  * `bash <(curl -Lso- https://git.io/kernel.sh)`
  * 选1->查看当前内核
    * ~~选49->安装6.1内核,(中途会重启几次,重新选就行)~~
    * ~~选2->启用bbr和cake算法~~
  * 选66->安装bbrPlus6.1内核
  * 选3,4->启用bbrPlus和cake算法
  * 如果弹窗Abort kernel removal, 选否

# acme:
  * <https://github.com/acmesh-official/acme.sh>
  * `apt install socat`
  * `wget -O - https://get.acme.sh | sh -s email=your@email.com`
  * `source  ~/.bashrc`
  * `export CF_Token=your_dns_key`
    * <https://github.com/acmesh-official/acme.sh/wiki/dnsapi#dns_cf>
  * `acme.sh --issue --dns dns_cf -d example.com -d '*.example.com'`
  * `mkdir -p /usr/local/nginx/conf/cert`
  * ```
    acme.sh --install-cert -d example.com \
    --cert-file /etc/ssl/certs/cert.pem \
    --key-file /etc/ssl/private/key.pem \
    --reloadcmd "service nginx force-reload"
    ```
  * 如果已经在cloudflare里面配置过dns,那么dns申请域名就不用关闭cloudflare小云朵了
  * 查看已有证书 `acme.sh --list`
  * 删除已有证书 `acme.sh --remove --domain example.com`

# nginx:
  * `apt install nginx`
  * `nano /etc/nginx/conf.d/example.conf`
  * `sudo nginx -t && systemctl restart nginx.service`

# 四合一脚本:
  * <https://github.com/yonggekkk/sing-box-yg>
  * `bash <(wget -qO- https://raw.githubusercontent.com/yonggekkk/sing-box-yg/main/sb.sh)`
  * 选1->一键安装Sing-box, 然后一路回车, 证书默认bing自签即可
  * 按4, 把hy2单端口改成40001, 多端口改成40000:49999
  * 按9-2, 查看订阅连接, 然后把订阅复制到gist secret里面就行了
  * 查看端口跳跃:
  * `host_ip=$(hostname -i);tcpdump -nn -G 1 udp | awk '{print 1,3}' | awk "/$host_ip.(4[0-9]{4})/"`
  * 端口跳跃需要在客户端修改clash配置文件: ports: 40000-49999

# 1panel:
  * <https://github.com/1Panel-dev/1Panel>
  * `curl -sSL https://resource.fit2cloud.com/1panel/package/quick_start.sh -o quick_start.sh && sudo bash quick_start.sh`
  * `1pctl user-info`
  * `1pctl uninstall`
  * 保存好: 初次入口,端口,帐号,密码

# subconvert:
  * <https://github.com/tindy2013/subconverter/issues/518>
  * <https://github.com/asdlokj1qpi23/subconverter>
  * 为了支持hy2, 不用官方的,用修改版的
  * `docker run -d --restart=always -p 22000:25500 asdlokj1qpi23/subconverter:latest`

# it-tools:
  * <https://github.com/CorentinTh/it-tools>
  * `docker run -d --name it-tools --restart unless-stopped -p 22562:80 corentinth/it-tools:latest`

# enclosed:
  * ```
    docker run -d --name enclosed --restart unless-stopped -p 4573:8787 \
      -e PUBLIC_IS_AUTHENTICATION_REQUIRED="true" \
      -e AUTHENTICATION_USERS="name_password" corentinth/enclosed
    ```
  * 打开这个网址输入帐号密码, 勾选Escape for Docker Run
    * `https://docs.enclosed.cc/self-hosting/users-authentication-key-generator`

# FileCodeBox:
  * https://github.com/vastsa/FileCodeBox
  * `docker run -d --restart=always -p 23840:12345 -v /opt/FileCodeBox/:/app/data --name filecodebox lanol/filecodebox:beta`
  * 记得安装完登录后台改下密码
  * 默认后端地址：/#/admin
  * 默认后台密码：FileCodeBox2023
  * 更改密码
  * 关闭游客上传
  * 增加上传文件大小限制为1GB

# chatgpt-next:
# aurora:
# deeplx:

